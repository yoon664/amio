<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íšŒì „ ì¹´ë“œ ë·°ì–´</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: white;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        .table {
            position: relative;
            width: 600px;
            height: 600px;
        }

        .card-container {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.3s ease;
            cursor: grab;
        }

        .card-container:active {
            cursor: grabbing;
        }

        .card {
            position: absolute;
            width: 80px;
            height: 120px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
            border: 2px solid #ddd;
            opacity: 0;
            transform-origin: center;
        }

        .card.visible {
            opacity: 1 !important;
        }

        .card:hover {
            z-index: 15;
        }

        .card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }

        .card-number {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .drag-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateX(-50%) translateY(0);
            }
            40% {
                transform: translateX(-50%) translateY(-10px);
            }
            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        @keyframes dealCard {
            0% {
                transform: translate(-50%, -50%) scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2) rotate(180deg);
                opacity: 0.8;
            }
            100% {
                opacity: 0.3;
            }
        }

        .card.dealing {
            animation: dealCard 0.8s ease-out forwards;
        }

        .card.visible {
            opacity: 1 !important;
        }
    </style>
</head>
<body>
    <div class="table">
        <div class="card-container" id="cardContainer">
        </div>
    </div>
    
    <div class="drag-hint">
        ğŸ–±ï¸ ë“œë˜ê·¸í•´ì„œ ì¹´ë“œë¥¼ íšŒì „ì‹œí‚¤ì„¸ìš”
    </div>

    <script>
        let cardImage = null;
        let isDragging = false;
        let startAngle = 0;
        let currentRotation = 0;
        let lastMouseAngle = 0;
        const cardCount = 16;
        const visibleCardCount = 5;

        // ì¹´ë“œ ì´ë¯¸ì§€ ì„¤ì •
        async function loadCardImage() {
            cardImage = 'img/1.png';
        }

        // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ë¥¼ ê°ë„ë¡œ ë³€í™˜
        function getAngleFromMouse(clientX, clientY) {
            const rect = document.querySelector('.table').getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            const deltaX = clientX - centerX;
            const deltaY = clientY - centerY;
            
            return Math.atan2(deltaY, deltaX) * 180 / Math.PI;
        }

        // ë³´ì´ëŠ” ì¹´ë“œ ì—…ë°ì´íŠ¸
        function updateVisibleCards() {
            const cards = document.querySelectorAll('.card');
            const centerIndex = Math.round(-currentRotation / (360 / cardCount)) % cardCount;
            const normalizedCenterIndex = centerIndex < 0 ? centerIndex + cardCount : centerIndex;
            
            console.log('í˜„ì¬ ì¤‘ì•™ ì¸ë±ìŠ¤:', normalizedCenterIndex);
            
            cards.forEach((card, index) => {
                card.classList.remove('visible');
                
                // ì¤‘ì•™ì„ ê¸°ì¤€ìœ¼ë¡œ ì•ë’¤ 2ê°œì”©, ì´ 5ê°œ ì¹´ë“œê°€ ë³´ì´ë„ë¡
                const distanceFromCenter = Math.min(
                    Math.abs(index - normalizedCenterIndex),
                    cardCount - Math.abs(index - normalizedCenterIndex)
                );
                
                if (distanceFromCenter <= 2) {
                    card.classList.add('visible');
                    console.log(`ì¹´ë“œ ${index + 1} visible ì¶”ê°€, distance: ${distanceFromCenter}`);
                }
            });
        }

        // ì¹´ë“œ ìƒì„± ë° ë°°ì¹˜
        async function createCards() {
            await loadCardImage();
            
            const container = document.getElementById('cardContainer');
            const centerX = 300;
            const centerY = 300;
            const radius = 220;

            for (let i = 0; i < cardCount; i++) {
                const card = document.createElement('div');
                card.className = 'card';
                
                // ê°ë„ ê³„ì‚° (12ì‹œ ë°©í–¥ë¶€í„° ì‹œì‘)
                const angle = (360 / cardCount) * i - 90; // -90ë„ë¡œ 12ì‹œ ë°©í–¥ ì‹œì‘
                const radian = (angle * Math.PI) / 180;
                
                const x = centerX + Math.cos(radian) * radius;
                const y = centerY + Math.sin(radian) * radius;
                
                card.style.left = (x - 40) + 'px';
                card.style.top = (y - 60) + 'px';
                
                // ì¹´ë“œê°€ ì¤‘ì•™ì„ í–¥í•˜ë„ë¡ íšŒì „
                const rotationAngle = angle + 90;
                card.style.transform = `rotate(${rotationAngle}deg)`;
                
                card.innerHTML = `
                    <img src="${cardImage}" alt="ê³ ê° ë¦¬ë·°${i + 1}" onerror="this.style.display='none'">
                    <div class="card-number">${i + 1}</div>
                `;
                
                // ì¹´ë“œ í´ë¦­ ì´ë²¤íŠ¸ (ë’¤ì§‘ê¸° ì• ë‹ˆë©”ì´ì…˜ ì œê±°)
                card.addEventListener('click', (e) => {
                    e.stopPropagation();
                    console.log(`ì¹´ë“œ ${i + 1} í´ë¦­ë¨`);
                });
                
                container.appendChild(card);
                
                setTimeout(() => {
                    card.classList.add('dealing');
                }, i * 100);
            }
            
            // ì´ˆê¸° ë³´ì´ëŠ” ì¹´ë“œ ì„¤ì • (ìœ„ìª½ 5ê°œ ì¹´ë“œê°€ ë³´ì´ë„ë¡)
            setTimeout(() => {
                updateVisibleCards();
                console.log('ì´ˆê¸° visible ì¹´ë“œ ì„¤ì • ì™„ë£Œ');
            }, cardCount * 100 + 1000);
        }

        // ë“œë˜ê·¸ ì´ë²¤íŠ¸
        function handleMouseDown(e) {
            isDragging = true;
            startAngle = getAngleFromMouse(e.clientX, e.clientY);
            lastMouseAngle = startAngle;
            const hint = document.querySelector('.drag-hint');
            if (hint) hint.style.display = 'none';
        }

        function handleMouseMove(e) {
            if (!isDragging) return;
            
            const mouseAngle = getAngleFromMouse(e.clientX, e.clientY);
            let deltaAngle = mouseAngle - lastMouseAngle;
            
            // ê°ë„ ì°¨ì´ê°€ 180ë„ë³´ë‹¤ í¬ë©´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ê³„ì‚°
            if (deltaAngle > 180) deltaAngle -= 360;
            if (deltaAngle < -180) deltaAngle += 360;
            
            currentRotation += deltaAngle;
            lastMouseAngle = mouseAngle;
            
            const container = document.getElementById('cardContainer');
            container.style.transform = `rotate(${currentRotation}deg)`;
            
            updateVisibleCards();
        }

        function handleMouseUp() {
            isDragging = false;
            
            // ìŠ¤ëƒ… ê¸°ëŠ¥: ê°€ì¥ ê°€ê¹Œìš´ ì¹´ë“œ ìœ„ì¹˜ë¡œ ë§ì¶¤
            const snapAngle = 360 / cardCount;
            const snappedRotation = Math.round(currentRotation / snapAngle) * snapAngle;
            currentRotation = snappedRotation;
            
            const container = document.getElementById('cardContainer');
            container.style.transform = `rotate(${currentRotation}deg)`;
            
            updateVisibleCards();
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ë§Œ)
        document.addEventListener('mousedown', handleMouseDown);
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);

        // í˜ì´ì§€ ë¡œë“œì‹œ ì¹´ë“œ ìƒì„±
        createCards();
    </script>
</body>
</html>